# Python env   : MicroPython v1.23.0
# -*- coding: utf-8 -*-
# @Time    : 2024/9/19 下午9:09
# @Author  : 李清水
# @File    : main.py
# @Description : PWM类使用，驱动蜂鸣器播放MIDI音乐

# ======================================== 导入相关模块 =========================================

# 导入时间相关模块
import time

# 导入蜂鸣器驱动类
from buzzer import Buzzer

# ======================================== 全局变量 ============================================

# 小星星的旋律和节奏:即每个音符和其对应持续时间
MELODY = [
    ("C4", 400),
    ("C4", 400),
    ("G4", 400),
    ("G4", 400),
    ("A4", 400),
    ("A4", 400),
    ("G4", 800),
    ("F4", 400),
    ("F4", 400),
    ("E4", 400),
    ("E4", 400),
    ("D4", 400),
    ("D4", 400),
    ("C4", 800),
    ("G4", 400),
    ("G4", 400),
    ("F4", 400),
    ("F4", 400),
    ("E4", 400),
    ("E4", 400),
    ("D4", 800),
    ("G4", 400),
    ("G4", 400),
    ("F4", 400),
    ("F4", 400),
    ("E4", 400),
    ("E4", 400),
    ("D4", 800),
    ("C4", 400),
    ("C4", 400),
    ("G4", 400),
    ("G4", 400),
    ("A4", 400),
    ("A4", 400),
    ("G4", 800),
    ("F4", 400),
    ("F4", 400),
    ("E4", 400),
    ("E4", 400),
    ("D4", 400),
    ("D4", 400),
    ("C4", 800),
]

# ======================================== 功能函数 ============================================

# ======================================== 自定义类 ============================================

# ======================================== 初始化配置 ==========================================

# 上电延时3s
time.sleep(3)
# 打印调试信息
print("FreakStudio : Use PWM to drive a buzzer to play MIDI music")
# 初始化蜂鸣器对象
buzzer = Buzzer(pin=6)

# ========================================  主程序  ===========================================

# 循环播放音乐
while True:
    # 播放旋律《小星星》
    buzzer.play_melody(MELODY)
